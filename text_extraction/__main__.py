from text_extraction import *
import os


def print_data(dataset):
    if len(dataset) == 0:
        print('\tNot found')
    for i in dataset:
        print('\t', i)


def print_dict_data(dataset):
    for k, v in dataset.items():
        print('\t', k)
        if len(v) == 0:
            print('\t\tNot found')
        else:
            print('\t\t', ', '.join(v))


file_name = input('File path: ')
temp_directory_name, text = parse_pdf(file_name)
special_words = extract_special_words(text)
print('Registry keys')
registry_keys = registry_keys_extract(special_words)
print_data(registry_keys)
special_words = clear_registry_keys(special_words)
hashes = extract_hashes(text, special_words=special_words)
print()
print('Hashes')
print_dict_data(hashes)
print()
special_words = clear_hashes(special_words, hashes)
special_words = clear_special_words(special_words)
print('Special words')
print_data(special_words)
print()
names = extract_all_names(text)
extractor = CountryInfoExtract(names)
print('Countries')
countries = extractor.extract_countries()
print_data(countries)
print()
print('Cities')
cities = extractor.extract_cities()
print_data(cities)
print()
print('Country regions')
country_regions = extractor.extract_country_regions()
print_data(country_regions)
print()
print('Global regions')
global_regions = extractor.deeply_extract_global_region()
print_data(global_regions)
print()
print('MITRE ATT&CK techniques')
print_data(search_techniques(text))
files, extensions = extract_file_names(text)
print()
print('File names')
print_data(files)
print()
print('File extensions')
print_data(extensions)
domain_names = extract_domain_names(text)
print()
print('Domain names')
print_data(domain_names)
ip_addresses = extract_ip_addresses(text)
print()
print('Ip addresses')
print_data(ip_addresses)
providers = extract_providers(text)
print()
print('Providers')
print_data(providers)
protocols = extract_protocols(text)
print()
print('Protocols')
print_data(protocols)
images_text = extract_languages_from_images(temp_directory_name, remove=True)
languages = get_languages(images_text)
print()
print('Program languages')
print_data(languages)
companies, software = extract_companies_software(names - cities - countries - country_regions)
print()
print('Companies')
print_data(companies)
print()
print('Software')
print_data(software)
